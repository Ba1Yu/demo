<!DOCTYPE HTML>
<html>
 <head>
  <meta charset="utf-8">
  <title> 五子棋游戏 </title>
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <link rel="stylesheet" href="css/game.css">
 <body>
	<div>
		<table>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
		</table>
	</div>
 </body>
 <script>
 var tds = document.getElementsByTagName('td');
 var tables = document.getElementsByTagName('table');
 var con = true;//控制黑白子的变量
 //鼠标跟随框
 for(var i=0; i<tds.length; i++){
	tds[i].onclick=function (i){
			return function(){
				if(tds[i].style.background!=""){return;}//防止重复单击棋子
				if(!con){
					con=true;
					tds[i].style.background="url('images/white.png') center center no-repeat";
					tds[i].name='white';
					check(i,i,i);
				}
				else{
					con=false;
					tds[i].style.background="url('images/black.png') center center no-repeat";
					tds[i].name='black';
					check(i,i,i);
				}
			}
	}(i);
 }

 //此后为算法，即计算何时胜利的算法
 //左右检查 //上下检查 //斜向检查
 function check(l,m,n){
 //首先需要计算行和列，每行是19个格子，第一行是0-18
	var group=parseInt(l/19);//先获取行数,从0开始到18
	var col=l-group*19//获取列数，从0开始到18
	var hnum=1;//检查棋子横向计数
	var znum=0;//检查棋子纵向计数
	var lrnum=0;//检查棋子斜向计数
	var rlnum=0;//检查棋子斜向计数

	if(tds[l].name=='white'){//如果落子为白色则检查白色棋子
		//横向
		for (var hnum1=l+1;hnum1<=19*(group+1)-1 ;hnum1++ ){
			if(tds[hnum1].name=='white'){hnum+=1;}
			else{break;}
		}
		for (var hnum2=l-1;hnum2>=19*group ;hnum2-- ){
			if (tds[hnum2].name=='white'){hnum+=1;}
			else{break;}
		}
		//纵向
		for (var znum1=l;znum1<=19*19 ;znum1+=19 ){
			if(tds[znum1].name=='white'){znum+=1;}
			else{break;}
		}
		for (var znum2=l;znum2>=0 ;znum2-=19 ){
			if (tds[znum2].name=='white'){znum+=1;}
			else{break;}
		}
		//左下到右上斜向
		for (lrnum1=col,lrnum2=group; lrnum2>=0&&lrnum2<=18&&lrnum1>=0&&lrnum1<=18 ;lrnum1++,lrnum2-- ){
			if(tds[lrnum1+lrnum2*19].name=='white'){lrnum+=1;}
			else{break;}
		}
		for (lrnum3=col,lrnum4=group; lrnum4>=0&&lrnum4<=18&&lrnum3>=0&&lrnum3<=18 ;lrnum3--,lrnum4++){
			if (tds[lrnum3+lrnum4*19].name=='white'){lrnum+=1;}
			else{break;}
		}
		//右下到左上斜向
		for (rlnum1=col,rlnum2=group; rlnum2>=0&&rlnum2<=18&&rlnum1>=0&&rlnum1<=18 ;rlnum1++,rlnum2++ ){
			if(tds[rlnum1+rlnum2*19].name=='white'){rlnum+=1;}
			else{break;}
		}
		for (rlnum3=col,rlnum4=group; rlnum4>=0&&rlnum4<=18&&rlnum3>=0&&rlnum3<=18 ;rlnum3--,rlnum4--){
			if (tds[rlnum3+rlnum4*19].name=='white'){rlnum+=1;}
			else{break;}
		}

		if(hnum>=5||znum>=6||lrnum>=6||rlnum>=6) res('白');
	}
	else{//如果落子为黑色则检查黑色棋子
		//横向
		for (var hnum3=l+1;hnum3<=19*(group+1)-1 ;hnum3++ ){
			if(tds[hnum3].name=='black'){hnum+=1;}
			else{break;}
		}
		for (var hnum4=l-1;hnum4>=19*group ;hnum4-- ){
			if (tds[hnum4].name=='black'){hnum+=1;}
			else{break;}
		}
		//纵向
		for (var znum3=l;znum3<=19*19 ;znum3+=19 ){
			if(tds[znum3].name=='black'){znum+=1;}
			else{break;}
		}
		for (var znum3=l;znum3>=0 ;znum3-=19 ){
			if (tds[znum3].name=='black'){znum+=1;}
			else{break;}
		}
		//左下到右上斜向
		for (lrnum5=col,lrnum6=group; lrnum6>=0&&lrnum6<=18&&lrnum5>=0&&lrnum5<=18 ;lrnum5++,lrnum6-- ){
			if(tds[lrnum5+lrnum6*19].name=='black'){lrnum+=1;}
			else{break;}
		}
		for (lrnum7=col,lrnum8=group; lrnum8>=0&&lrnum8<=18&&lrnum7>=0&&lrnum7<=18 ;lrnum7--,lrnum8++){
			if (tds[lrnum7+lrnum8*19].name=='black'){lrnum+=1;}
			else{break;}
		}
		//右下到左上斜向
		for (rlnum5=col,rlnum6=group; rlnum6>=0&&rlnum6<=18&&rlnum5>=0&&rlnum5<=18 ;rlnum5++,rlnum6++ ){
			if(tds[rlnum5+rlnum6*19].name=='black'){rlnum+=1;}
			else{break;}
		}
		for (rlnum7=col,rlnum8=group; rlnum8>=0&&rlnum8<=18&&rlnum7>=0&&rlnum7<=18 ;rlnum7--,rlnum8--){
			if (tds[rlnum7+rlnum8*19].name=='black'){rlnum+=1;}
			else{break;}
		}

		if(hnum>=5||znum>=6||lrnum>=6||rlnum>=6) res('黑');
	}
 }
 function res(result){
	alert('游戏结束，获胜方是：'+result+'方');
	window.top.location.reload();
 }
 </script>
</html>